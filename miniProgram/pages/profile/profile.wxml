<!--profile.wxml-->
<view class="container">
  <!-- 用户信息 -->
  <view class="card">
    <view class="user-info">
      <view class="avatar-section">
        <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <button class="btn btn-secondary btn-sm" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
          更换头像
        </button>
      </view>
      <view class="user-details">
        <view class="nickname-section">
          <text class="nickname">{{userInfo.nickName || '微信用户'}}</text>
          <button class="btn btn-secondary btn-sm" bindtap="showNicknameModal">
            编辑昵称
          </button>
        </view>
        <text class="user-desc">欢迎使用转盘抽取小程序</text>
      </view>
    </view>
  </view>

  <!-- 数据统计 -->
  <view class="card">
    <view class="card-header">
      <text>我的数据</text>
    </view>
    <view class="card-body">
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-number">{{statistics.totalSets}}</text>
          <text class="stat-label">转盘套餐</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.totalItems}}</text>
          <text class="stat-label">选项数量</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.totalSpins}}</text>
          <text class="stat-label">转动次数</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{statistics.todaySpins}}</text>
          <text class="stat-label">今日转动</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="card">
    <view class="card-header">
      <text>功能</text>
    </view>
    <view class="card-body">
      <view class="menu-list">
        <view class="menu-item" bindtap="exportData">
          <view class="menu-icon">📤</view>
          <view class="menu-info">
            <text class="menu-title">导出数据</text>
            <text class="menu-desc">导出所有转盘数据</text>
          </view>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="importData">
          <view class="menu-icon">📥</view>
          <view class="menu-info">
            <text class="menu-title">导入数据</text>
            <text class="menu-desc">从文件导入转盘数据</text>
          </view>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="clearData">
          <view class="menu-icon">🗑️</view>
          <view class="menu-info">
            <text class="menu-title">清空数据</text>
            <text class="menu-desc">清除所有本地数据</text>
          </view>
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
  </view>

  <!-- 设置 -->
  <view class="card">
    <view class="card-header">
      <text>设置</text>
    </view>
    <view class="card-body">
      <view class="setting-list">
        <view class="setting-item">
          <text class="setting-label">音效开关</text>
          <switch checked="{{settings.soundEnabled}}" bindchange="onSoundToggle" color="#6750a4"></switch>
        </view>
        <view class="setting-item">
          <text class="setting-label">震动反馈</text>
          <switch checked="{{settings.vibrationEnabled}}" bindchange="onVibrationToggle" color="#6750a4"></switch>
        </view>
        <view class="setting-item">
          <text class="setting-label">自动保存</text>
          <switch checked="{{settings.autoSave}}" bindchange="onAutoSaveToggle" color="#6750a4"></switch>
        </view>
      </view>
    </view>
  </view>

  <!-- 关于 -->
  <view class="card">
    <view class="card-header">
      <text>关于</text>
    </view>
    <view class="card-body">
      <view class="about-info">
        <view class="about-item">
          <text class="about-label">版本信息：</text>
          <text class="about-value">v1.0.0</text>
        </view>
        <view class="about-item">
          <text class="about-label">更新时间：</text>
          <text class="about-value">2024-01-01</text>
        </view>
        <view class="about-item">
          <text class="about-label">开发者：</text>
          <text class="about-value">转盘抽取团队</text>
        </view>
      </view>
      <view class="about-actions">
        <button class="btn btn-secondary" bindtap="shareApp">分享小程序</button>
        <button class="btn btn-primary" bindtap="contactUs">意见反馈</button>
      </view>
    </view>
  </view>

  <!-- 昵称编辑弹窗 -->
  <view class="modal {{showNicknameModal ? 'show' : ''}}" bindtap="hideNicknameModal">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <text class="modal-title">编辑昵称</text>
        <button class="modal-close" bindtap="hideNicknameModal">×</button>
      </view>
      <view class="modal-body">
        <view class="form-group">
          <text class="form-label">昵称</text>
          <input 
            class="input" 
            placeholder="请输入昵称" 
            value="{{nicknameForm}}"
            bindinput="onNicknameInput"
            maxlength="20"
            type="nickname"
          />
        </view>
      </view>
      <view class="modal-footer">
        <button class="btn btn-secondary" bindtap="hideNicknameModal">取消</button>
        <button class="btn btn-primary" bindtap="saveNickname">保存</button>
      </view>
    </view>
  </view>
</view>
